<!doctype html>
<html>
  <head>
    <style>
      html, body {
        padding: 0;
        margin: 0;
        font-family: sans-serif;
      }

      .column {
        width: 50%;
        float: left;
        box-sizing: border-box;
        padding: 20px;
      }

      .row {
        width: 100%;
        height: 45px;
        color: #FFF;
        text-align: center;
        padding-top: 30px;
        font-weight: bold;
        text-shadow: 2px 2px 1px #333;
        background-color: lightblue;
      }
    </style>
  </head>

  <body>
    <main>
      <div class="column" key="left">
        <div class="row" key="0">0</div>
        <div class="row" key="1">1</div>
        <div class="row" key="2">2</div>
        <div class="row" key="3">3</div>
      </div>

      <div class="column" key="right">
        <button onclick="window.shuffle()">Reorder</button>
        <button onclick="window.add()">Add</button>
        <button onclick="window.remove()">Remove</button>
      </div>
    </main>

    <script src="diffhtml-logger/dist/logger.js"></script>
    <script src="diffhtml-verify-state/dist/verify-state.js"></script>
    <script src="dist/diffhtml.js"></script>

    <script>
      let items = [
        { key: '0', label: '0' },
        { key: '1', label: '1' },
        { key: '2', label: '2' },
        { key: '3', label: '3' },
      ];

      const shuffle = array => {
        let currentIndex = array.length, temporaryValue, randomIndex;

        while (0 !== currentIndex) {
          randomIndex = Math.floor(Math.random() * currentIndex);
          currentIndex -= 1;
          temporaryValue = array[currentIndex];
          array[currentIndex] = array[randomIndex];
          array[randomIndex] = temporaryValue;
        }

        return array;
      }

      const { innerHTML, html, use } = diff;

      use(logger());
      use(verifyState.default({ debug: location.search.includes('debug') }));

      window.shuffle = () => {
        items = shuffle(items);
        render();
      };

      window.add = () => {
        items.push({ key: items.length, label: items.length });
        render();
      };

      window.remove = () => {
        items.splice(items.length - 1, 1);
        render();
      };

      const render = () => {
        innerHTML(document.querySelector('main'), html`
          <div class="column" key="left">
            ${items.map(({ key, label }) => html`
              <div class="row" key="${key}">${label}</div>
              <hr />
            `)}
          </div>

          <div class="column" key="right">
            <button onclick=${shuffle}>Reorder</button>
            <button onclick=${add}>Add</button>
            <button onclick=${remove}>Remove</button>
          </div>
        `);
      };
    </script>
  </body>
</html>
